#include "mirco_shapefactors.h"

#include <stdexcept>

namespace
{
  // Shape factors (See section 3.3 of https://doi.org/10.1007/s00466-019-01791-3)
  // These are the shape factors to calculate the elastic compliance correction of the micro-scale
  // contact constitutive law for various N (number of elements/cells on the side length). These
  // were calculated with the flatMirco utility, which solves a flat indentor problem.

  // The following pressure based constants were computed with PressureGreenFunFlag=true, which uses
  // the pressure based Green function described in Pohrt and Li (2014)
  // (https://doi.org/10.1134/s1029959914040109).
  constexpr double shape_factors_pressure[] = {-1, 1.1221997046783601, 1.0068605251532488,
      0.9613892379176019, 0.9385553774805636, 0.9247153424324350, 0.9154315222403194,
      0.9087685392496160, 0.9037519877715218, 0.8998375318806962, 0.8966971707662922,
      0.8941214388008707, 0.8919702710377437, 0.8901464435834808, 0.8885803476015516,
      0.8872208283196537, 0.8860294454171728, 0.8849767510419420, 0.8840398035738947,
      0.8832004634308469, 0.8824441981346325, 0.8817592274578133, 0.8811359008070118,
      0.8805662363985259, 0.8800435751941624, 0.8795623175713739, 0.8791177205270475,
      0.8787057397731858, 0.8783229055386894, 0.8779662239682801, 0.8776330981656890,
      0.8773212644600161, 0.8770287405762021, 0.8767537831928627, 0.8764948529612128,
      0.8762505854977565, 0.8760197671930583, 0.8758013149284212, 0.8755942589829983,
      0.8753977285605655, 0.8752109394790312, 0.8750331836546562, 0.8748638200828373,
      0.8747022670726454, 0.8745479955362805, 0.8744005231699363, 0.8742594093907923,
      0.8741242509179714, 0.8739946779037813, 0.8738703505369391, 0.8737509560518956,
      0.8736362060886743, 0.8735258343562665, 0.8734195945595116, 0.8733172585555268,
      0.8732186147105027, 0.8731234664318931, 0.8730316308545857, 0.8729429376624449,
      0.8728572280293105, 0.8727743536654614, 0.8726941759576228, 0.8726165651917526,
      0.8725413998497341, 0.8724685659716702, 0.8723979565768808, 0.8723294711373156,
      0.8722630150979976, 0.8721984994395883, 0.8721358402788718, 0.8720749585033825,
      0.8720157794368235, 0.8719582325321097, 0.8719022510897959, 0.8718477719991118,
      0.8717947354996002, 0.8717430849616298, 0.8716927666839056, 0.8716437297064161,
      0.8715959256377300, 0.8715493084949260, 0.8715038345556940, 0.8714594622208272,
      0.8714161518869751, 0.8713738658281955, 0.8713325680860242, 0.8712922243670308,
      0.8712528019475217, 0.8712142695847320, 0.8711765974338808, 0.8711397569708169,
      0.8711037209197332, 0.8710684631855966, 0.8710339587908762, 0.8710001838163262,
      0.8709671153454953, 0.8709347314127101, 0.8709030109542123, 0.8708719337623513,
      0.8708414804424698, 0.8708116323724223, 0.8707823716644704, 0.8707536811294082,
      0.8707255442427749, 0.8706979451130293, 0.8706708684514870, 0.8706442995440021,
      0.8706182242242418, 0.8705926288483617, 0.8705675002711998, 0.8705428258235575,
      0.8705185932910341, 0.8704947908935766, 0.8704714072665237, 0.8704484314423007,
      0.8704258528332731, 0.8704036612155071, 0.8703818467131095, 0.8703603997836795,
      0.8703393112042895, 0.8703185720581894, 0.8702981737222819, 0.8702781078550472,
      0.8702583663851622, 0.8702389415006436, 0.8702198256385448, 0.8702010114750534,
      0.8701824919161373, 0.8701642600885777, 0.8701463093314787, 0.8701286331880788,
      0.8701112253980428, 0.8700940798899756, 0.8700771907744420, 0.8700605523370255,
      0.8700441590321332, 0.8700280054765305, 0.8700120864436413, 0.8699963968577851,
      0.8699809317888031, 0.8699656864468288, 0.8699506561774307, 0.8699358364567527,
      0.8699212228870455, 0.8699068111922218, 0.8698925972137674, 0.8698785769066384,
      0.8698647463354736, 0.8698511016708782, 0.8698376391859030, 0.8698243552525671,
      0.8698112463386797, 0.8697983090047073, 0.8697855399006192, 0.8697729357631443,
      0.8697604934129470, 0.8697482097518102, 0.8697360817602870, 0.8697241064950695,
      0.8697122810865264, 0.8697006027366636, 0.8696890687166858, 0.8696776763649489,
      0.8696664230848258, 0.8696553063428933, 0.8696443236668953, 0.8696334726438837,
      0.8696227509186125, 0.8696121561916351, 0.8696016862177504, 0.8695913388044054,
      0.8695811118101908, 0.8695710031432342, 0.8695610107600104, 0.8695511326636424,
      0.8695413669028539, 0.8695317115705510, 0.8695221648025113, 0.8695127247764532,
      0.8695033897103885, 0.8694941578620170, 0.8694850275273125, 0.8694759970396558,
      0.8694670647686289, 0.8694582291192037, 0.8694494885307213, 0.8694408414759704,
      0.8694322864602663, 0.8694238220206283, 0.8694154467249828, 0.8694071591712467,
      0.8693989579866118, 0.8693908418268620, 0.8693828093753529, 0.8693748593427119,
      0.8693669904658110, 0.8693592015072276, 0.8693514912546110, 0.8693438585199682,
      0.8693363021391828, 0.8693288209713197, 0.8693214138980255, 0.8693140798230476,
      0.8693068176716898, 0.8692996263902650, 0.8692925049455287, 0.8692854523242664,
      0.8692784675327826, 0.8692715495964258, 0.8692646975591457, 0.8692579104829866,
      0.8692511874478274, 0.8692445275507632, 0.8692379299058196, 0.8692313936434972,
      0.8692249179105069, 0.8692185018692402, 0.8692121446974803, 0.8692058455881195,
      0.8691996037485457, 0.8691934184008847, 0.8691872887808929, 0.8691812141383196,
      0.8691751937361777, 0.8691692268507080, 0.8691633127709625, 0.8691574507984686,
      0.8691516402470387, 0.8691458804425888, 0.8691401707225926, 0.8691345104361811,
      0.8691288989436776, 0.8691233356163260, 0.8691178198362033, 0.8691123509959157,
      0.8691069284983031, 0.8691015517564127, 0.8690962201930285, 0.8690909332407664,
      0.8690856903415835, 0.8690804909467174, 0.8690753345165753, 0.8690702205203589,
      0.8690651484360690, 0.8690601177501829, 0.8690551279574679, 0.8690501785611041,
      0.8690452690720238, 0.8690403990092065, 0.8690355678992394, 0.8690307752763420,
      0.8690260206820745, 0.8690213036652830, 0.8690166237819072, 0.8690119805948787,
      0.8690073736739279, 0.8690028025955288, 0.8689982669426989, 0.8689937663049347,
      0.8689893002780077, 0.8689848684639400, 0.8689804704707742, 0.8689761059126675,
      0.8689717744093126, 0.8689674755865471, 0.8689632090755510, 0.8689589745131810,
      0.8689547715415663, 0.8689505998083972, 0.8689464589663355, 0.8689423486734029,
      0.8689382685923617, 0.8689342183913050, 0.8689301977428563, 0.8689262063245560,
      0.8689222438185548, 0.8689183099116432, 0.8689144042950885, 0.8689105266646471,
      0.8689066767203163, 0.8689028541665227, 0.8688990587117054, 0.8688952900685281,
      0.8688915479537926, 0.8688878320880427, 0.8688841421959848, 0.8688804780060290,
      0.8688768392502936, 0.8688732256647946, 0.8688696369890391, 0.8688660729662970,
      0.8688625333429951, 0.8688590178694482, 0.8688555262991509, 0.8688520583889607,
      0.8688486138990065, 0.8688451925927414, 0.8688417942366389, 0.8688384186004615,
      0.8688350654569874, 0.8688317345819273, 0.8688284257541964, 0.8688251387552690,
      0.8688218733698881, 0.8688186293853285, 0.8688154065917445, 0.8688122047820819,
      0.8688090237519270, 0.8688058632994651, 0.8688027232257157, 0.8687996033338304,
      0.8687965034298418, 0.8687934233222178, 0.8687903628216703, 0.8687873217417135,
      0.8687842998976999, 0.8687812971076854, 0.8687783131918726, 0.8687753479727642,
      0.8687724012751081, 0.8687694729257391, 0.8687665627537832, 0.8687636705903488,
      0.8687607962687079, 0.8687579396241218, 0.8687551004939515, 0.8687522787175699,
      0.8687494741361942, 0.8687466865929865, 0.8687439159331450, 0.8687411620036171,
      0.8687384246531886, 0.8687357037325769, 0.8687329990941778, 0.8687303105921662,
      0.8687276380825413, 0.8687249814228213, 0.8687223404724350, 0.8687197150923835,
      0.8687171051451423, 0.8687145104951409, 0.8687119310081105, 0.8687093665514681,
      0.8687068169940001, 0.8687042822063991, 0.8687017620604578, 0.8686992564296598,
      0.8686967651888532, 0.8686942882142978, 0.8686918253838958, 0.8686893765765682,
      0.8686869416730011, 0.8686845205549630, 0.8686821131055816, 0.8686797192093836,
      0.8686773387523407, 0.8686749716213333, 0.8686726177047439, 0.8686702768922260,
      0.8686679490744973, 0.8686656341436800, 0.8686633319929589, 0.8686610425166605,
      0.8686587656105527, 0.8686565011710621, 0.8686542490961787, 0.8686520092848510,
      0.8686497816370484, 0.8686475660539862, 0.8686453624377736, 0.8686431706916574,
      0.8686409907200418, 0.8686388224281339, 0.8686366657223337, 0.8686345205099202,
      0.8686323866991644, 0.8686302641995434, 0.8686281529211343, 0.8686260527752763,
      0.8686239636738734, 0.8686218855301189, 0.8686198182580674, 0.8686177617723495,
      0.8686157159889695, 0.8686136808243813, 0.8686116561961026, 0.8686096420225635,
      0.8686076382229652, 0.8686056447170526, 0.8686036614259891, 0.8686016882711866,
      0.8685997251752667, 0.8685977720613947, 0.8685958288534995, 0.8685938954765421,
      0.8685919718559021, 0.8685900579179070, 0.8685881535897464, 0.8685862587989447,
      0.8685843734742329, 0.8685824975444921, 0.8685806309399995, 0.8685787735911717,
      0.8685769254292993, 0.8685750863863544, 0.8685732563949614, 0.8685714353884044,
      0.8685696233008916, 0.8685678200665881, 0.8685660256211138, 0.8685642399000324,
      0.8685624628400674, 0.8685606943782042, 0.8685589344522117, 0.8685571830003902,
      0.8685554399616412, 0.8685537052754838, 0.8685519788819339, 0.8685502607216495,
      0.8685485507360085, 0.8685468488664825, 0.8685451550556073, 0.8685434692461576,
      0.8685417913816439, 0.8685401214058847, 0.8685384592632945, 0.8685368048990116,
      0.8685351582585910, 0.8685335192878467, 0.8685318879332946, 0.8685302641421764,
      0.8685286478616304, 0.8685270390399917, 0.8685254376255052, 0.8685238435671330,
      0.8685222568143627, 0.8685206773168872, 0.8685191050252885, 0.8685175398900848,
      0.8685159818627115, 0.8685144308947212, 0.8685128869383024, 0.8685113499458071,
      0.8685098198703530, 0.8685082966653377, 0.8685067802844647, 0.8685052706820447,
      0.8685037678127424, 0.8685022716314172, 0.8685007820936091, 0.8684992991551941,
      0.8684978227722623, 0.8684963529015566, 0.8684948894999456, 0.8684934325248493,
      0.8684919819339803, 0.8684905376855071, 0.8684890997377955, 0.8684876680497804,
      0.8684862425806296, 0.8684848232898319, 0.8684834101374826, 0.8684820030834635,
      0.8684806020887146, 0.8684792071139200, 0.8684778181206487, 0.8684764350699824,
      0.8684750579243778, 0.8684736866457705, 0.8684723211967658, 0.8684709615403531,
      0.8684696076397100, 0.8684682594582742, 0.8684669169599123, 0.8684655801086781,
      0.8684642488691093, 0.8684629232057773, 0.8684616030838634, 0.8684602884686153,
      0.8684589793255353, 0.8684576756206449, 0.8684563773201929, 0.8684550843903360,
      0.8684537967979755, 0.8684525145101769, 0.8684512374941173, 0.8684499657174733,
      0.8684486991476852, 0.8684474377532247, 0.8684461815022282, 0.8684449303632715,
      0.8684436843053789, 0.8684424432973727, 0.8684412073088440, 0.8684399763093705,
      0.8684387502686052, 0.8684375291567903, 0.8684363129440809, 0.8684351016012404,
      0.8684338950988889, 0.8684326934082330, 0.8684314965005212, 0.8684303043469460,
      0.8684291169196034, 0.8684279341901663, 0.8684267561309261, 0.8684255827142362,
      0.8684244139127122, 0.8684232496991027, 0.8684220900464893, 0.8684209349281152,
      0.8684197843174793, 0.8684186381879919, 0.8684174965138375};
  constexpr int shape_factors_pressure_length =
      sizeof(shape_factors_pressure) / sizeof(shape_factors_pressure[0]);

  // The following force based constants were computed with PressureGreenFunFlag=false.
  constexpr double shape_factors_force[] = {-1, 0.6366197723675814, 0.7666699475984320,
      0.7789585415133602, 0.7961148796273941, 0.8055133886663757, 0.8127671025256030,
      0.8182212743711261, 0.8225746236818395, 0.8261268713954162, 0.8290942114643841,
      0.8316154836131895, 0.8337888231068056, 0.8356846634614012, 0.8373552576125837,
      0.8388402081677774, 0.8401701442066313, 0.8413691581105132, 0.8424564856686131,
      0.8434476875988886, 0.8443554991640697, 0.8451904522744961, 0.8459613386543430,
      0.8466755598119302, 0.8473393950447318, 0.8479582091819997, 0.8485366154076104,
      0.8490786041754905, 0.8495876462335299, 0.8500667756660438, 0.8505186573640674,
      0.8509456422492288, 0.8513498127851887, 0.8517330207256517, 0.8520969186112199,
      0.8524429861981521, 0.8527725527516871, 0.8530868159445046, 0.8533868579523674,
      0.8536736592232858, 0.8539481103057767, 0.8542110220500827, 0.8544631344392536,
      0.8547051242614272, 0.8549376117980163, 0.8551611666729038, 0.8553763129836737,
      0.8555835338162737, 0.8557832752283748, 0.8559759497734233, 0.8561619396263829,
      0.8563415993630449, 0.8565152584371540, 0.8566832233932402, 0.8568457798476746,
      0.8570031942659552, 0.8571557155604181, 0.8573035765293110, 0.8574469951554204,
      0.8575861757800831, 0.8577213101663957, 0.8578525784637072, 0.8579801500839872,
      0.8581041844993790, 0.8582248319691329, 0.8583422342031545, 0.8584565249685565,
      0.8585678306448844, 0.8586762707330372, 0.8587819583223574, 0.8588850005198675,
      0.8589854988452061, 0.8590835495944390, 0.8591792441755849, 0.8592726694184045,
      0.8593639078607394, 0.8594530380134580, 0.8595401346058623, 0.8596252688132241,
      0.8597085084679600, 0.8597899182558099, 0.8598695598982516, 0.8599474923222772,
      0.8600237718185371, 0.8600984521887903, 0.8601715848834820, 0.8602432191302349,
      0.8603134020539349, 0.8603821787890578, 0.8604495925848173, 0.8605156849036653,
      0.8605804955136338, 0.8606440625749662, 0.8607064227214443, 0.8607676111367959,
      0.8608276616265186, 0.8608866066854460, 0.8609444775613513, 0.8610013043148486,
      0.8610571158758532, 0.8611119400968251, 0.8611658038030077, 0.8612187328398614,
      0.8612707521178755, 0.8613218856549215, 0.8613721566163075, 0.8614215873526855,
      0.8614701994359272, 0.8615180136931193, 0.8615650502387702, 0.8616113285053553,
      0.8616568672722853, 0.8617016846934070, 0.8617457983231103, 0.8617892251411321,
      0.8618319815761285, 0.8618740835280874, 0.8619155463896501, 0.8619563850663980,
      0.8619966139961722, 0.8620362471674669, 0.8620752981369624, 0.8621137800462316,
      0.8621517056376766, 0.8621890872697267, 0.8622259369313450, 0.8622622662558769,
      0.8622980865342763, 0.8623334087277400, 0.8623682434797848, 0.8624026011277925,
      0.8624364917140522, 0.8624699249963241, 0.8625029104579499, 0.8625354573175312,
      0.8625675745382014, 0.8625992708365019, 0.8626305546908942, 0.8626614343499157,
      0.8626919178400013, 0.8627220129729872, 0.8627517273533051, 0.8627810683848944,
      0.8628100432778316, 0.8628386590546989, 0.8628669225567036, 0.8628948404495524,
      0.8629224192291035, 0.8629496652267957, 0.8629765846148715, 0.8630031834113979,
      0.8630294674851023, 0.8630554425600212, 0.8630811142199767, 0.8631064879128890,
      0.8631315689549250, 0.8631563625345007, 0.8631808737161303, 0.8632051074441430,
      0.8632290685462630, 0.8632527617370590, 0.8632761916212744, 0.8632993626970408,
      0.8633222793589725, 0.8633449459011610, 0.8633673665200586, 0.8633895453172679,
      0.8634114863022317, 0.8634331933948330, 0.8634546704279070, 0.8634759211496676,
      0.8634969492260542, 0.8635177582429966, 0.8635383517086114, 0.8635587330553187,
      0.8635789056418952, 0.8635988727554561, 0.8636186376133780, 0.8636382033651537,
      0.8636575730941929, 0.8636767498195632, 0.8636957364976744, 0.8637145360239136,
      0.8637331512342267, 0.8637515849066502, 0.8637698397627963, 0.8637879184692936,
      0.8638058236391805, 0.8638235578332585, 0.8638411235614043, 0.8638585232838408,
      0.8638757594123718, 0.8638928343115788, 0.8639097502999816, 0.8639265096511665,
      0.8639431145948788, 0.8639595673180863, 0.8639758699660086, 0.8639920246431202,
      0.8640080334141197, 0.8640238983048776, 0.8640396213033517, 0.8640552043604773,
      0.8640706493910361, 0.8640859582744969, 0.8641011328558319, 0.8641161749463151,
      0.8641310863242933, 0.8641458687359401, 0.8641605238959846, 0.8641750534884257,
      0.8641894591672217, 0.8642037425569652, 0.8642179052535373, 0.8642319488247457,
      0.8642458748109449, 0.8642596847256396, 0.8642733800560747, 0.8642869622638051,
      0.8643004327852566, 0.8643137930322645, 0.8643270443926074, 0.8643401882305184,
      0.8643532258871899, 0.8643661586812594, 0.8643789879092900, 0.8643917148462318,
      0.8644043407458760, 0.8644168668412958, 0.8644292943452766, 0.8644416244507360,
      0.8644538583311315, 0.8644659971408616, 0.8644780420156528, 0.8644899940729400,
      0.8645018544122375, 0.8645136241154979, 0.8645253042474678, 0.8645368958560281,
      0.8645483999725339, 0.8645598176121382, 0.8645711497741146, 0.8645823974421669,
      0.8645935615847380, 0.8646046431553018, 0.8646156430926590, 0.8646265623212190,
      0.8646374017512770, 0.8646481622792852, 0.8646588447881172, 0.8646694501473267,
      0.8646799792134001, 0.8646904328300038, 0.8647008118282240, 0.8647111170268040,
      0.8647213492323739, 0.8647315092396761, 0.8647415978317847, 0.8647516157803233,
      0.8647615638456714, 0.8647714427771751, 0.8647812533133442, 0.8647909961820518,
      0.8648006721007258, 0.8648102817765376, 0.8648198259065868, 0.8648293051780809,
      0.8648387202685111, 0.8648480718458278, 0.8648573605686065, 0.8648665870862137,
      0.8648757520389704, 0.8648848560583098, 0.8648938997669310, 0.8649028837789532,
      0.8649118087000621, 0.8649206751276578, 0.8649294836509948, 0.8649382348513230,
      0.8649469293020258, 0.8649555675687500, 0.8649641502095420, 0.8649726777749716,
      0.8649811508082611, 0.8649895698454078, 0.8649979354153036, 0.8650062480398548,
      0.8650145082340980, 0.8650227165063130, 0.8650308733581347, 0.8650389792846626,
      0.8650470347745672, 0.8650550403101964, 0.8650629963676757, 0.8650709034170119,
      0.8650787619221906, 0.8650865723412726, 0.8650943351264918, 0.8651020507243438,
      0.8651097195756821, 0.8651173421158050, 0.8651249187745450, 0.8651324499763526,
      0.8651399361403853, 0.8651473776805867, 0.8651547750057695, 0.8651621285196965,
      0.8651694386211568, 0.8651767057040451, 0.8651839301574362, 0.8651911123656585,
      0.8651982527083676, 0.8652053515606183, 0.8652124092929340, 0.8652194262713742,
      0.8652264028576055, 0.8652333394089652, 0.8652402362785261, 0.8652470938151633,
      0.8652539123636140, 0.8652606922645413, 0.8652674338545933, 0.8652741374664628,
      0.8652808034289482, 0.8652874320670062, 0.8652940237018129, 0.8653005786508150,
      0.8653070972277899, 0.8653135797428916, 0.8653200265027079, 0.8653264378103123,
      0.8653328139653136, 0.8653391552639063, 0.8653454619989166, 0.8653517344598551,
      0.8653579729329602, 0.8653641777012491, 0.8653703490445563, 0.8653764872395856,
      0.8653825925599519, 0.8653886652762222, 0.8653947056559607, 0.8654007139637708,
      0.8654066904613343, 0.8654126354074572, 0.8654185490580989, 0.8654244316664255,
      0.8654302834828353, 0.8654361047550062, 0.8654418957279255, 0.8654476566439341,
      0.8654533877427562, 0.8654590892615389, 0.8654647614348834, 0.8654704044948832,
      0.8654760186711554, 0.8654816041908753, 0.8654871612788059, 0.8654926901573352,
      0.8654981910465033, 0.8655036641640367, 0.8655091097253768, 0.8655145279437121,
      0.8655199190300036, 0.8655252831930194, 0.8655306206393613, 0.8655359315734908,
      0.8655412161977621, 0.8655464747124435, 0.8655517073157468, 0.8655569142038565,
      0.8655620955709522, 0.8655672516092373, 0.8655723825089613, 0.8655774884584471,
      0.8655825696441141, 0.8655876262505042, 0.8655926584603028, 0.8655976664543653,
      0.8656026504117394, 0.8656076105096857, 0.8656125469237012, 0.8656174598275440,
      0.8656223493932501, 0.8656272157911613, 0.8656320591899389, 0.8656368797565887,
      0.8656416776564824, 0.8656464530533753, 0.8656512061094274, 0.8656559369852206,
      0.8656606458397842, 0.8656653328306059, 0.8656699981136550, 0.8656746418433996,
      0.8656792641728284, 0.8656838652534619, 0.8656884452353744, 0.8656930042672113,
      0.8656975424962062, 0.8657020600681951, 0.8657065571276366, 0.8657110338176250,
      0.8657154902799101, 0.8657199266549102, 0.8657243430817307, 0.8657287396981731,
      0.8657331166407616, 0.8657374740447442, 0.8657418120441198, 0.8657461307716463,
      0.8657504303588569, 0.8657547109360730, 0.8657589726324196, 0.8657632155758407,
      0.8657674398931055, 0.8657716457098336, 0.8657758331504986, 0.8657800023384442,
      0.8657841533958990, 0.8657882864439860, 0.8657924016027411, 0.8657964989911117,
      0.8658005787269886, 0.8658046409272054, 0.8658086857075439, 0.8658127131827675,
      0.8658167234666112, 0.8658207166718069, 0.8658246929100849, 0.8658286522921922,
      0.8658325949279009, 0.8658365209260167, 0.8658404303943956, 0.8658443234399475,
      0.8658482001686497, 0.8658520606855584, 0.8658559050948175, 0.8658597334996673,
      0.8658635460024554, 0.8658673427046478, 0.8658711237068377, 0.8658748891087521,
      0.8658786390092682, 0.8658823735064106, 0.8658860926973748, 0.8658897966785255,
      0.8658934855454098, 0.8658971593927646, 0.8659008183145288, 0.8659044624038432,
      0.8659080917530688, 0.8659117064537920, 0.8659153065968298, 0.8659188922722378,
      0.8659224635693227, 0.8659260205766462, 0.8659295633820352, 0.8659330920725906,
      0.8659366067346873, 0.8659401074539903, 0.8659435943154639, 0.8659470674033632,
      0.8659505268012617, 0.8659539725920463, 0.8659574048579251, 0.8659608236804356,
      0.8659642291404592, 0.8659676213182108, 0.8659710002932638, 0.8659743661445454,
      0.8659777189503465, 0.8659810587883284, 0.8659843857355274, 0.8659876998683688,
      0.8659910012626538, 0.8659942899935928, 0.8659975661357900, 0.8660008297632564,
      0.8660040809494186, 0.8660073197671222, 0.8660105462886359, 0.8660137605856570,
      0.8660169627293254, 0.8660201527902166, 0.8660233308383560, 0.8660264969432194,
      0.8660296511737436, 0.8660327935983267, 0.8660359242848360, 0.8660390433006124,
      0.8660421507124771, 0.8660452465867309, 0.8660483309891694, 0.8660514039850784,
      0.8660544656392439, 0.8660575160159560, 0.8660605551790114, 0.8660635831917212,
      0.8660666001169134, 0.8660696060169421, 0.8660726009536841, 0.8660755849885481,
      0.8660785581824835, 0.8660815205959740, 0.8660844722890531, 0.8660874133212981,
      0.8660903437518465, 0.8660932636393861, 0.8660961730421726, 0.8660990720180245,
      0.8661019606243293, 0.8661048389180533, 0.8661077069557319};
  constexpr int shape_factors_force_length =
      sizeof(shape_factors_force) / sizeof(shape_factors_force[0]);
}  // namespace

double MIRCO::getShapeFactor(const int N, const bool pressureGreenFunFlag)
{
  const auto* shape_factors = pressureGreenFunFlag ? shape_factors_pressure : shape_factors_force;
  const int length =
      pressureGreenFunFlag ? shape_factors_pressure_length : shape_factors_force_length;

  if (N < 0 || N >= length || shape_factors[N] == -1)
    throw std::runtime_error(
        "No shape factor available for N=" + std::to_string(N) +
        " and PressureGreenFunFlag=" + (pressureGreenFunFlag ? "true" : "false"));

  return shape_factors[N];
}
